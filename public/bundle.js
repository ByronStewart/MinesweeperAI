var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function l(e){e.forEach(t)}function i(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function r(e,t){e.appendChild(t)}function o(e,t,n){e.insertBefore(t,n||null)}function c(e){e.parentNode.removeChild(e)}function s(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function u(e){return document.createElement(e)}function d(e){return document.createTextNode(e)}function f(){return d(" ")}function g(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function v(e){return function(t){return t.preventDefault(),e.call(this,t)}}function h(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function p(e,t){t=""+t,e.data!==t&&(e.data=t)}let m;function $(e){m=e}function x(e){(function(){if(!m)throw new Error("Function called outside component initialization");return m})().$$.on_mount.push(e)}function y(){const e=m;return(t,n)=>{const l=e.$$.callbacks[t];if(l){const i=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);l.slice().forEach(t=>{t.call(e,i)})}}}const b=[],M=[],R=[],_=[],F=Promise.resolve();let S=!1;function k(e){R.push(e)}function w(){const e=new Set;do{for(;b.length;){const e=b.shift();$(e),C(e.$$)}for(;M.length;)M.pop()();for(let t=0;t<R.length;t+=1){const n=R[t];e.has(n)||(n(),e.add(n))}R.length=0}while(b.length);for(;_.length;)_.pop()();S=!1}function C(e){e.fragment&&(e.update(e.dirty),l(e.before_update),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_update.forEach(k))}const E=new Set;let A;function B(){A={r:0,c:[],p:A}}function q(){A.r||l(A.c),A=A.p}function j(e,t){e&&e.i&&(E.delete(e),e.i(t))}function N(e,t,n,l){if(e&&e.o){if(E.has(e))return;E.add(e),A.c.push(()=>{E.delete(e),l&&(n&&e.d(1),l())}),e.o(t)}}function O(e,n,a){const{fragment:r,on_mount:o,on_destroy:c,after_update:s}=e.$$;r.m(n,a),k(()=>{const n=o.map(t).filter(i);c?c.push(...n):l(n),e.$$.on_mount=[]}),s.forEach(k)}function I(e,t){e.$$.fragment&&(l(e.$$.on_destroy),e.$$.fragment.d(t),e.$$.on_destroy=e.$$.fragment=null,e.$$.ctx={})}function L(e,t){e.$$.dirty||(b.push(e),S||(S=!0,F.then(w)),e.$$.dirty=n()),e.$$.dirty[t]=!0}function z(t,i,a,r,o,c){const s=m;$(t);const u=i.props||{},d=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:o,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(s?s.$$.context:[]),callbacks:n(),dirty:null};let f=!1;var g;d.ctx=a?a(t,u,(e,n,l=n)=>(d.ctx&&o(d.ctx[e],d.ctx[e]=l)&&(d.bound[e]&&d.bound[e](l),f&&L(t,e)),n)):u,d.update(),f=!0,l(d.before_update),d.fragment=r(d.ctx),i.target&&(i.hydrate?d.fragment.l((g=i.target,Array.from(g.childNodes))):d.fragment.c(),i.intro&&j(t.$$.fragment),O(t,i.target,i.anchor),w()),$(s)}class G{$destroy(){I(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function T(t){var n,i;return{c(){h(n=u("div"),"class","cell svelte-1qte4k2"),i=[g(n,"click",t.click_handler_1),g(n,"contextmenu",v(t.contextmenu_handler_1))]},m(e,t){o(e,n,t)},p:e,d(e){e&&c(n),l(i)}}}function D(t){var n,i;return{c(){(n=u("div")).textContent="!!",h(n,"class","cell flagged svelte-1qte4k2"),i=[g(n,"contextmenu",v(t.contextmenu_handler)),g(n,"click",t.click_handler)]},m(e,t){o(e,n,t)},p:e,d(e){e&&c(n),l(i)}}}function H(e){var t,n,l=0===e.value?"":e.value+"";return{c(){t=u("div"),n=d(l),h(t,"class","cell revealed svelte-1qte4k2")},m(e,l){o(e,t,l),r(t,n)},p(e,t){e.value&&l!==(l=0===t.value?"":t.value+"")&&p(n,l)},d(e){e&&c(t)}}}function P(t){var n;return{c(){(n=u("div")).textContent="*",h(n,"class","cell mine svelte-1qte4k2")},m(e,t){o(e,n,t)},p:e,d(e){e&&c(n)}}}function J(t){var n;function l(e,t){return t.isRevealed&&t.isMine?P:t.isRevealed?H:t.isFlagged?D:T}var i=l(0,t),a=i(t);return{c(){a.c(),n=d("")},m(e,t){a.m(e,t),o(e,n,t)},p(e,t){i===(i=l(0,t))&&a?a.p(e,t):(a.d(1),(a=i(t))&&(a.c(),a.m(n.parentNode,n)))},i:e,o:e,d(e){a.d(e),e&&c(n)}}}function K(e,t,n){let{isRevealed:l,value:i,isMine:a,id:r,isFlagged:o}=t;const c=y();return e.$set=(e=>{"isRevealed"in e&&n("isRevealed",l=e.isRevealed),"value"in e&&n("value",i=e.value),"isMine"in e&&n("isMine",a=e.isMine),"id"in e&&n("id",r=e.id),"isFlagged"in e&&n("isFlagged",o=e.isFlagged)}),{isRevealed:l,value:i,isMine:a,id:r,isFlagged:o,dispatch:c,contextmenu_handler:()=>c("cell-flagged"),click_handler:()=>c("cell-clicked"),click_handler_1:()=>c("cell-clicked"),contextmenu_handler_1:()=>c("cell-flagged")}}class Q extends G{constructor(e){super(),z(this,e,K,J,a,["isRevealed","value","isMine","id","isFlagged"])}}function U(e,t){return[{x:e-1,y:t-1},{x:e-1,y:t},{x:e-1,y:t+1},{x:e,y:t-1},{x:e,y:t+1},{x:e+1,y:t-1},{x:e+1,y:t},{x:e+1,y:t+1}]}function V(e,t,n){const l=Object.create(e);return l.cell=t[n],l.y=n,l}function W(e,t,n){const l=Object.create(e);return l.row=t[n],l.x=n,l}function X(e){var t;var n=new Q({props:{isRevealed:e.cell.isRevealed,isMine:e.cell.isMine,isFlagged:e.cell.isFlagged,value:e.cell.value,id:e.cell.id}});return n.$on("cell-clicked",function(){return e.cell_clicked_handler(e)}),n.$on("cell-flagged",function(){return e.cell_flagged_handler(e)}),{c(){n.$$.fragment.c()},m(e,l){O(n,e,l),t=!0},p(t,l){e=l;var i={};t.boardState&&(i.isRevealed=e.cell.isRevealed),t.boardState&&(i.isMine=e.cell.isMine),t.boardState&&(i.isFlagged=e.cell.isFlagged),t.boardState&&(i.value=e.cell.value),t.boardState&&(i.id=e.cell.id),n.$set(i)},i(e){t||(j(n.$$.fragment,e),t=!0)},o(e){N(n.$$.fragment,e),t=!1},d(e){I(n,e)}}}function Y(e){var t,n,l;let i=e.row,a=[];for(let t=0;t<i.length;t+=1)a[t]=X(V(e,i,t));const d=e=>N(a[e],1,1,()=>{a[e]=null});return{c(){t=u("div");for(let e=0;e<a.length;e+=1)a[e].c();n=f(),h(t,"class","game-col svelte-1cxp91l")},m(e,i){o(e,t,i);for(let e=0;e<a.length;e+=1)a[e].m(t,null);r(t,n),l=!0},p(e,l){if(e.boardState){let r;for(i=l.row,r=0;r<i.length;r+=1){const o=V(l,i,r);a[r]?(a[r].p(e,o),j(a[r],1)):(a[r]=X(o),a[r].c(),j(a[r],1),a[r].m(t,n))}for(B(),r=i.length;r<a.length;r+=1)d(r);q()}},i(e){if(!l){for(let e=0;e<i.length;e+=1)j(a[e]);l=!0}},o(e){a=a.filter(Boolean);for(let e=0;e<a.length;e+=1)N(a[e]);l=!1},d(e){e&&c(t),s(a,e)}}}function Z(e){var t,n,i,a,m,$,x,y,b,M,R,_,F,S,k,w;let C=e.boardState,E=[];for(let t=0;t<C.length;t+=1)E[t]=Y(W(e,C,t));const A=e=>N(E[e],1,1,()=>{E[e]=null});return{c(){t=u("div"),(n=u("form")).innerHTML='<button type="submit">Reset</button>',i=f(),a=u("div"),m=d("Mines remaining: "),$=d(e.apparentMinesRemaining),x=f(),(y=u("button")).textContent="Choose Move",b=f(),(M=u("button")).textContent="Solve Board",R=f(),(_=u("button")).textContent="Stop Solver",F=f(),S=u("div");for(let e=0;e<E.length;e+=1)E[e].c();h(t,"class","menu"),h(S,"class","game-row svelte-1cxp91l"),w=[g(n,"submit",v(e.resetGame)),g(y,"click",e.suggestMove),g(M,"click",e.solveBoard),g(_,"click",e.stopSolver)]},m(e,l){o(e,t,l),r(t,n),o(e,i,l),o(e,a,l),r(a,m),r(a,$),o(e,x,l),o(e,y,l),o(e,b,l),o(e,M,l),o(e,R,l),o(e,_,l),o(e,F,l),o(e,S,l);for(let e=0;e<E.length;e+=1)E[e].m(S,null);k=!0},p(e,t){if(k&&!e.apparentMinesRemaining||p($,t.apparentMinesRemaining),e.boardState){let n;for(C=t.boardState,n=0;n<C.length;n+=1){const l=W(t,C,n);E[n]?(E[n].p(e,l),j(E[n],1)):(E[n]=Y(l),E[n].c(),j(E[n],1),E[n].m(S,null))}for(B(),n=C.length;n<E.length;n+=1)A(n);q()}},i(e){if(!k){for(let e=0;e<C.length;e+=1)j(E[e]);k=!0}},o(e){E=E.filter(Boolean);for(let e=0;e<E.length;e+=1)N(E[e]);k=!1},d(e){e&&(c(t),c(i),c(a),c(x),c(y),c(b),c(M),c(R),c(_),c(F),c(S)),s(E,e),l(w)}}}let ee=20,te=20,ne=50;function le(e,t,n){let l,i=[],a=ne,r=ne;function o(){console.log("solving");const{idArr:e,toFlag:t,toReveal:n}=function(e){for(let t=0;t<e.length;t++){if(0==e[t].value)return{idArr:e[t].fields,toReveal:!0,toFlag:!1};if(e[t].value==e[t].fields.length)return{idArr:e[t].fields,toReveal:!1,toFlag:!0}}return{idArr:null,toReveal:null,toFlag:null}}(d);if(e)for(let l=0;l<e.length;l++){const{x:a,y:r}={y:(i=e[l])%te,x:Math.floor(i/te)};t?s(a,r):n&&u(a,r)}else alert("no simple move remaining"),console.log(d),clearInterval(l);var i}function c(){n("boardState",i=new Array(ee).fill().map((e,t)=>new Array(te).fill().map((e,n)=>({id:t*te+n,isRevealed:!1,isMine:!1,isFlagged:!1,value:10})))),n("boardState",i=function(e,t){const n=e.length,l=e[0].length,i=new Array(l*n).fill().map((e,t)=>t);for(let l=0;l<t;l++){let t=(a=0,r=i.length-1,Math.floor(Math.random()*(r-a+1)+a)),l=i[t];i.splice(t,1),e[l%n][Math.floor(l/n)].isMine=!0}var a,r;return e}(i,ne)),n("boardState",i=function(e){const t=e.length,n=e[0].length;for(let l=0;l<t;l++)for(let i=0;i<n;i++){if(e[l][i].isMine){e[l][i].value=100;continue}let a=0,r=U(l,i);for(let l=0;l<r.length;l++)r[l].x<0||r[l].y<0||r[l].x>=t||r[l].y>=n||e[r[l].x][r[l].y].isMine&&a++;e[l][i].value=a}return e}(i)),n("apparentMinesRemaining",a=ne),n("actualMinesRemaining",r=ne)}function s(e,t){i[e][t].isFlagged?n("apparentMinesRemaining",a++,a):n("apparentMinesRemaining",a--,a),!i[e][t].isFlagged&&i[e][t].isMine?n("actualMinesRemaining",r--,r):i[e][t].isFlagged&&i[e][t].isMine&&n("actualMinesRemaining",r++,r),n("boardState",i[e][t].isFlagged=!i[e][t].isFlagged,i),n("boardState",i)}function u(e,t){0===i[e][t].value&&function e(t,n,l){const i=t.length,a=t[0].length;if(n<0||l<0||n>=i||l>=a)return;const r=t[n][l];if(!r.isRevealed&&(r.isRevealed=!0,0===r.value)){let i=U(n,l);for(let n=0;n<i.length;n++)e(t,i[n].x,i[n].y)}}(i,e,t),n("boardState",i[e][t].isRevealed=!0,i),n("boardState",i)}x(()=>{c()});let d;return e.$$.update=((e={boardState:1,actualMinesRemaining:1})=>{(e.boardState||e.actualMinesRemaining)&&(d=function(e,t){const n=[{fields:[],value:t}];for(let t=0;t<e.length;t++)for(let l=0;l<e[0].length;l++){if(e[t][l].isRevealed||e[t][l].isFlagged||n[0].fields.push(e[t][l].id),!e[t][l].isRevealed||0===e[t][l].value||e[t][l].isFlagged)continue;let i={fields:[],value:e[t][l].value},a=U(t,l);for(let t=0;t<a.length;t++)a[t].x<0||a[t].y<0||a[t].x>=e.length||a[t].y>=e[0].length||(e[a[t].x][a[t].y].isRevealed||e[a[t].x][a[t].y].isFlagged||i.fields.push(e[a[t].x][a[t].y].id),e[a[t].x][a[t].y].isFlagged&&i.value--);i.fields.length>0&&n.push(i)}return n.sort((e,t)=>e.fields.length-t.fields.length),n}(i,r))}),{boardState:i,apparentMinesRemaining:a,resetGame:function(){c()},solveBoard:function(){l=setInterval(o,50)},stopSolver:function(){clearInterval(l)},suggestMove:o,flagCell:s,revealCell:u,cell_clicked_handler:({x:e,y:t})=>u(e,t),cell_flagged_handler:({x:e,y:t})=>s(e,t)}}class ie extends G{constructor(e){super(),z(this,e,le,Z,a,[])}}function ae(t){var n,l,i,a=new ie({});return{c(){(n=u("h1")).textContent="Minesweeper Baby",l=f(),a.$$.fragment.c(),h(n,"class","svelte-1ucbz36")},m(e,t){o(e,n,t),o(e,l,t),O(a,e,t),i=!0},p:e,i(e){i||(j(a.$$.fragment,e),i=!0)},o(e){N(a.$$.fragment,e),i=!1},d(e){e&&(c(n),c(l)),I(a,e)}}}return new class extends G{constructor(e){super(),z(this,e,null,ae,a,[])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
